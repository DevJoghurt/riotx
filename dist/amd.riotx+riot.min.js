define(["mout/lang/isAsyncFunction"],function(s){"use strict";var e="2.0.2";s=s&&s.hasOwnProperty("default")?s["default"]:s;function t(t,e,n){if(t==null){return}var r=-1,i=t.length;while(++r<i){if(e.call(n,t[r],r,t)===false){break}}}var u=t;function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var f=n;var l,c;function p(){c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];l=true;for(var t in{toString:null}){l=false}}function r(t,e,n){var r,i=0;if(l==null){p()}for(r in t){if(h(e,t,r,n)===false){break}}if(l){var a=t.constructor,o=!!a&&t===a.prototype;while(r=c[i++]){if((r!=="constructor"||!o&&f(t,r))&&t[r]!==Object.prototype[r]){if(h(e,t,r,n)===false){break}}}}}function h(t,e,n,r){return t.call(r,e[n],n,e)}var a=r;function i(n,r,i){a(n,function(t,e){if(f(n,e)){return r.call(i,n[e],e,n)}})}var o=i;var v=Object.keys||function(t){var n=[];o(t,function(t,e){n.push(e)});return n};var d=v;function g(t){return Object.prototype.toString.call(t).slice(8,-1)}var m=g;function y(t,e){return m(t)===e}var _=y;function w(t){return _(t,"Function")}var b=w;function x(t){return _(t,"Object")}var N=x;var A=setTimeout;function O(){}function j(t,e){return function(){t.apply(e,arguments)}}function C(t){if(!(this instanceof C)){throw new TypeError("Promises must be constructed via new")}if(typeof t!=="function"){throw new TypeError("not a function")}this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];R(t,this)}function T(n,r){while(n._state===3){n=n._value}if(n._state===0){n._deferreds.push(r);return}n._handled=true;C._immediateFn(function(){var t=n._state===1?r.onFulfilled:r.onRejected;if(t===null){(n._state===1?E:k)(r.promise,n._value);return}var e;try{e=t(n._value)}catch(t){k(r.promise,t);return}E(r.promise,e)})}function E(e,t){try{if(t===e){throw new TypeError("A promise cannot be resolved with itself.")}if(t&&(typeof t==="object"||typeof t==="function")){var n=t.then;if(t instanceof C){e._state=3;e._value=t;L(e);return}else if(typeof n==="function"){R(j(n,t),e);return}}e._state=1;e._value=t;L(e)}catch(t){k(e,t)}}function k(t,e){t._state=2;t._value=e;L(t)}function L(t){if(t._state===2&&t._deferreds.length===0){C._immediateFn(function(){if(!t._handled){C._unhandledRejectionFn(t._value)}})}for(var e=0,n=t._deferreds.length;e<n;e++){T(t,t._deferreds[e])}t._deferreds=null}function S(t,e,n){this.onFulfilled=typeof t==="function"?t:null;this.onRejected=typeof e==="function"?e:null;this.promise=n}function R(t,e){var n=false;try{t(function(t){if(n){return}n=true;E(e,t)},function(t){if(n){return}n=true;k(e,t)})}catch(t){if(n){return}n=true;k(e,t)}}C.prototype["catch"]=function(t){return this.then(null,t)};C.prototype.then=function(t,e){var n=new this.constructor(O);T(this,new S(t,e,n));return n};C.prototype["finally"]=function(e){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){return n.reject(t)})})};C.all=function(e){return new C(function(r,i){if(!e||typeof e.length==="undefined"){throw new TypeError("Promise.all accepts an array")}var a=Array.prototype.slice.call(e);if(a.length===0){return r([])}var o=a.length;function s(e,t){try{if(t&&(typeof t==="object"||typeof t==="function")){var n=t.then;if(typeof n==="function"){n.call(t,function(t){s(e,t)},i);return}}a[e]=t;if(--o===0){r(a)}}catch(t){i(t)}}for(var t=0;t<a.length;t++){s(t,a[t])}})};C.resolve=function(e){if(e&&typeof e==="object"&&e.constructor===C){return e}return new C(function(t){t(e)})};C.reject=function(n){return new C(function(t,e){e(n)})};C.race=function(i){return new C(function(t,e){for(var n=0,r=i.length;n<r;n++){i[n].then(t,e)}})};C._immediateFn=typeof setImmediate==="function"&&function(t){setImmediate(t)}||function(t){A(t,0)};C._unhandledRejectionFn=function t(e){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",e)}};function I(t,e){return(e||document).querySelector(t)}var P=[],M={},B="yield",F="__global_mixin",V="riot-",$=["ref","data-ref"],U="data-is",H="if",D="each",z="no-reorder",K="show",q="hide",G="key",W="__riot-events__",Z="string",Q="object",J="undefined",X="function",Y="http://www.w3.org/1999/xlink",tt="http://www.w3.org/2000/svg",et=/^xlink:(\w+)/,nt=typeof window===J?undefined:window,rt=/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?|opt(?:ion|group))$/,it=/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?)$/,at=/^on/,ot=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g,st={viewbox:"viewBox",preserveaspectratio:"preserveAspectRatio"},ut=/^(?:disabled|checked|readonly|required|allowfullscreen|auto(?:focus|play)|compact|controls|default|formnovalidate|hidden|ismap|itemscope|loop|multiple|muted|no(?:resize|shade|validate|wrap)?|open|reversed|seamless|selected|sortable|truespeed|typemustmatch)$/,ft=(nt&&nt.document||{}).documentMode|0;function lt(t){return t==="svg"?document.createElementNS(tt,t):document.createElement(t)}function ct(t,e,n){var r=et.exec(e);if(r&&r[1]){t.setAttributeNS(Y,r[1],n)}else{t.setAttribute(e,n)}}var pt;var ht;var vt={};var dt=[];var gt=false;if(nt){pt=function(){var t=lt("style");var e=I("style[type=riot]");ct(t,"type","text/css");if(e){if(e.id){t.id=e.id}e.parentNode.replaceChild(t,e)}else{document.head.appendChild(t)}return t}();ht=pt.styleSheet}var mt={styleNode:pt,add:function t(e,n){if(n){vt[n]=e}else{dt.push(e)}gt=true},inject:function t(){if(!nt||!gt){return}gt=false;var e=Object.keys(vt).map(function(t){return vt[t]}).concat(dt).join("\n");if(ht){ht.cssText=e}else{pt.innerHTML=e}}};var yt=function(){var u="[{(,;:?=|&!^~>%*/";var f=["case","default","do","else","in","instanceof","prefix","return","typeof","void","yield"];var l=f.reduce(function(t,e){return t+e.slice(-1)},"");var c=/^\/(?=[^*>/])[^[/\\]*(?:(?:\\.|\[(?:\\.|[^\]\\]*)*\])[^[\\/]*)*?\/[gimuy]*/;var p=/[$\w]/;function h(t,e){while(--e>=0&&/\s/.test(t[e])){}return e}function t(t,e){var n=/.*/g;var r=n.lastIndex=e++;var i=n.exec(t)[0].match(c);if(i){var a=r+i[0].length;r=h(t,r);var o=t[r];if(r<0||~u.indexOf(o)){return a}if(o==="."){if(t[r-1]==="."){e=a}}else if(o==="+"||o==="-"){if(t[--r]!==o||(r=h(t,r))<0||!p.test(t[r])){e=a}}else if(~l.indexOf(o)){var s=r+1;while(--r>=0&&p.test(t[r])){}if(~f.indexOf(t.slice(r+1,s))){e=a}}}return e}return t}();var _t=function(t){var n="g",e=/\/\*[^*]*\*+(?:[^*\/][^*]*\*+)*\//g,r=/"[^"\\]*(?:\\[\S\s][^"\\]*)*"|'[^'\\]*(?:\\[\S\s][^'\\]*)*'|`[^`\\]*(?:\\[\S\s][^`\\]*)*`/g,i=r.source+"|"+/(?:\breturn\s+|(?:[$\w\)\]]|\+\+|--)\s*(\/)(?![*\/]))/.source+"|"+/\/(?=[^*\/])[^[\/\\]*(?:(?:\[(?:\\.|[^\]\\]*)*\]|\\.)[^[\/\\]*)*?([^<]\/)[gim]*/.source,a=RegExp("[\\"+"x00-\\x1F<>a-zA-Z0-9'\",;\\\\]"),o=/(?=[[\]()*+?.^$|])/g,s=r.source+"|"+/(\/)(?![*\/])/.source,_={"(":RegExp("([()])|"+s,n),"[":RegExp("([[\\]])|"+s,n),"{":RegExp("([{}])|"+s,n)},u="{ }";var f=["{","}","{","}",/{[^}]*}/,/\\([{}])/g,/\\({)|{/g,RegExp("\\\\(})|([[({])|(})|"+s,n),u,/^\s*{\^?\s*([$\w]+)(?:\s*,\s*(\S+))?\s+in\s+(\S.*)\s*}/,/(^|[^\\]){=[\S\s]*?}/];var l=t,c,w=[],p;function h(t){return t}function v(t,e){if(!e){e=w}return new RegExp(t.source.replace(/{/g,e[2]).replace(/}/g,e[3]),t.global?n:"")}function d(t){if(t===u){return f}var e=t.split(" ");if(e.length!==2||a.test(t)){throw new Error('Unsupported brackets "'+t+'"')}e=e.concat(t.replace(o,"\\").split(" "));e[4]=v(e[1].length>1?/{[\S\s]*?}/:f[4],e);e[5]=v(t.length>3?/\\({|})/g:f[5],e);e[6]=v(f[6],e);e[7]=RegExp("\\\\("+e[3]+")|([[({])|("+e[3]+")|"+s,n);e[8]=t;return e}function g(t){return t instanceof RegExp?c(t):w[t]}g.split=function t(r,i,e){if(!e){e=w}var n=[],a,o,s,u,f=e[6];var l=[];var c="";var p,h;o=s=f.lastIndex=0;while(a=f.exec(r)){h=f.lastIndex;u=a.index;if(o){if(a[2]){var v=a[2];var d=_[v];var g=1;d.lastIndex=h;while(a=d.exec(r)){if(a[1]){if(a[1]===v){++g}else if(!--g){break}}else{d.lastIndex=y(a.index,d.lastIndex,a[2])}}f.lastIndex=g?r.length:d.lastIndex;continue}if(!a[3]){f.lastIndex=y(u,h,a[4]);continue}}if(!a[1]){m(r.slice(s,u));s=f.lastIndex;f=e[6+(o^=1)];f.lastIndex=s}}if(r&&s<r.length){m(r.slice(s))}n.qblocks=l;return n;function m(t){if(c){t=c+t;c=""}if(i||o){n.push(t&&t.replace(e[5],"$1"))}else{n.push(t)}}function y(t,e,n){if(n){e=yt(r,t)}if(i&&e>t+2){p="‚Åó"+l.length+"~";l.push(r.slice(t,e));c+=r.slice(s,t)+p;s=e}return e}};g.hasExpr=function t(e){return w[4].test(e)};g.loopKeys=function t(e){var n=e.match(w[9]);return n?{key:n[1],pos:n[2],val:w[0]+n[3].trim()+w[1]}:{val:e.trim()}};g.array=function t(e){return e?d(e):w};function m(t){if((t||(t=u))!==w[8]){w=d(t);c=t===u?h:v;w[9]=c(f[9])}l=t}function y(t){var e;t=t||{};e=t.brackets;Object.defineProperty(t,"brackets",{set:m,get:function(){return l},enumerable:true});p=t;m(e)}Object.defineProperty(g,"settings",{set:y,get:function(){return p}});g.settings=typeof riot!=="undefined"&&riot.settings||{};g.set=m;g.skipRegex=yt;g.R_STRINGS=r;g.R_MLCOMMS=e;g.S_QBLOCKS=i;g.S_QBLOCK2=s;return g}();var wt=function(){var n={};function r(t,e){if(!t){return t}return(n[t]||(n[t]=a(t))).call(e,i.bind({data:e,tmpl:t}))}r.hasExpr=_t.hasExpr;r.loopKeys=_t.loopKeys;r.clearCache=function(){n={}};r.errorHandler=null;function i(t,e){t.riotData={tagName:e&&e.__&&e.__.tagName,_riot_id:e&&e._riot_id};if(r.errorHandler){r.errorHandler(t)}else if(typeof console!=="undefined"&&typeof console.error==="function"){console.error(t.message);console.log("<%s> %s",t.riotData.tagName||"Unknown tag",this.tmpl);console.log(this.data)}}function a(t){var e=o(t);if(e.slice(0,11)!=="try{return "){e="return "+e}return new Function("E",e+";")}var s=/\u2057/g;var u=/\u2057(\d+)~/g;function o(t){var e=_t.split(t.replace(s,'"'),1);var n=e.qblocks;var r;if(e.length>2||e[0]){var i,a,o=[];for(i=a=0;i<e.length;++i){r=e[i];if(r&&(r=i&1?f(r,1,n):'"'+r.replace(/\\/g,"\\\\").replace(/\r\n?|\n/g,"\\n").replace(/"/g,'\\"')+'"')){o[a++]=r}}r=a<2?o[0]:"["+o.join(",")+'].join("")'}else{r=f(e[1],0,n)}if(n.length){r=r.replace(u,function(t,e){return n[e].replace(/\r/g,"\\r").replace(/\n/g,"\\n")})}return r}var l=/^(?:(-?[_A-Za-z\xA0-\xFF][-\w\xA0-\xFF]*)|\u2057(\d+)~):/;var c={"(":/[()]/g,"[":/[[\]]/g,"{":/[{}]/g};function f(a,t,e){a=a.replace(/\s+/g," ").trim().replace(/\ ?([[\({},?\.:])\ ?/g,"$1");if(a){var n=[],r=0,i;while(a&&(i=a.match(l))&&!i.index){var o,s,u=/,|([[{(])|$/g;a=RegExp.rightContext;o=i[2]?e[i[2]].slice(1,-1).trim().replace(/\s+/g," "):i[1];while(s=(i=u.exec(a))[1]){f(s,u)}s=a.slice(0,i.index);a=RegExp.rightContext;n[r++]=d(s,1,o)}a=!r?d(a,t):r>1?"["+n.join(",")+'].join(" ").trim()':n[0]}return a;function f(t,e){var n,r=1,i=c[t];i.lastIndex=e.lastIndex;while(n=i.exec(a)){if(n[0]===t){++r}else if(!--r){break}}e.lastIndex=r?a.length:i.lastIndex}}var p='"in this?this:'+(typeof window!=="object"?"global":"window")+").",h=/[,{][\$\w]+(?=:)|(^ *|[^$\w\.{])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|Math)(?![$\w]))([$_A-Za-z][$\w]*)/g,v=/^(?=(\.[$\w]+))\1(?:[^.[(]|$)/;function d(t,e,n){var a;t=t.replace(h,function(t,e,n,r,i){if(n){r=a?0:r+t.length;if(n!=="this"&&n!=="global"&&n!=="window"){t=e+'("'+n+p+n;if(r){a=(i=i[r])==="."||i==="("||i==="["}}else if(r){a=!v.test(i.slice(r))}}return t});if(a){t="try{return "+t+"}catch(e){E(e,this)}"}if(n){t=(a?"function(){"+t+"}.call(this)":"("+t+")")+'?"'+n+'":""'}else if(e){t="function(v){"+(a?t.replace("return ","v="):"v=("+t+")")+';return v||v===0?v:""}.call(this)'}return t}r.version=_t.version="v3.0.8";return r}();var bt=function(s){s=s||{};var u={},f=Array.prototype.slice;Object.defineProperties(s,{on:{value:function(t,e){if(typeof e=="function"){(u[t]=u[t]||[]).push(e)}return s},enumerable:false,writable:false,configurable:false},off:{value:function(t,e){if(t=="*"&&!e){u={}}else{if(e){var n=u[t];for(var r=0,i;i=n&&n[r];++r){if(i==e){n.splice(r--,1)}}}else{delete u[t]}}return s},enumerable:false,writable:false,configurable:false},one:{value:function(t,e){function n(){s.off(t,n);e.apply(s,arguments)}return s.on(t,n)},enumerable:false,writable:false,configurable:false},trigger:{value:function(t){var e=arguments;var n=arguments.length-1,r=new Array(n),i,a,o;for(o=0;o<n;o++){r[o]=e[o+1]}i=f.call(u[t]||[],0);for(o=0;a=i[o];++o){a.apply(s,r)}if(u["*"]&&t!="*"){s.trigger.apply(s,["*",t].concat(r))}return s},enumerable:false,writable:false,configurable:false}});return s};function xt(t,e){return Object.getOwnPropertyDescriptor(t,e)}function Nt(t){return typeof t===J}function At(t,e){var n=xt(t,e);return Nt(t[e])||n&&n.writable}function Ot(t){var e;var n=1;var r=arguments;var i=r.length;for(;n<i;n++){if(e=r[n]){for(var a in e){if(At(t,a)){t[a]=e[a]}}}}return t}function jt(t){return Object.create(t)}var Ct=Ot(jt(_t.settings),{skipAnonymousTags:true,autoUpdate:true});function Tt(t,e){return[].slice.call((e||document).querySelectorAll(t))}function Et(){return document.createTextNode("")}function kt(t,e){t.style.display=e?"":"none";t.hidden=e?false:true}function Lt(t,e){return t.getAttribute(e)}function St(t,e){t.removeAttribute(e)}function Rt(t,e,n){if(n){var r=t.ownerDocument.importNode((new DOMParser).parseFromString('<svg xmlns="'+tt+'">'+e+"</svg>","application/xml").documentElement,true);t.appendChild(r)}else{t.innerHTML=e}}function It(t,e){if(!t){return}var n;while(n=ot.exec(t)){e(n[1].toLowerCase(),n[2]||n[3]||n[4])}}function Pt(){return document.createDocumentFragment()}function Mt(t,e,n){t.insertBefore(e,n.parentNode&&n)}function Bt(n){return Object.keys(n).reduce(function(t,e){return t+" "+e+": "+n[e]+";"},"")}function Ft(t,e,n){if(t){var r=e(t,n);var i;if(r===false){return}t=t.firstChild;while(t){i=t.nextSibling;Ft(t,e,r);t=i}}}var Vt=Object.freeze({$$:Tt,$:I,createDOMPlaceholder:Et,mkEl:lt,setAttr:ct,toggleVisibility:kt,getAttr:Lt,remAttr:St,setInnerHTML:Rt,walkAttrs:It,createFrag:Pt,safeInsert:Mt,styleObjectToString:Bt,walkNodes:Ft});function $t(t){return Nt(t)||t===null}function Ut(t){return $t(t)||t===""}function Ht(t){return typeof t===X}function Dt(t){return t&&typeof t===Q}function zt(t){var e=t.ownerSVGElement;return!!e||e===null}function Kt(t){return Array.isArray(t)||t instanceof Array}function qt(t){return ut.test(t)}function Gt(t){return typeof t===Z}var Wt=Object.freeze({isBlank:Ut,isFunction:Ht,isObject:Dt,isSvg:zt,isWritable:At,isArray:Kt,isBoolAttr:qt,isNil:$t,isString:Gt,isUndefined:Nt});function Zt(t,e){return t.indexOf(e)!==-1}function Qt(t,e){var n=t?t.length:0;var r=0;for(;r<n;r++){e(t[r],r)}return t}function Jt(t,e){return t.slice(0,e.length)===e}var Xt=function t(){var e=-1;return function(){return++e}}();function Yt(t,e,n,r){Object.defineProperty(t,e,Ot({value:n,enumerable:false,writable:false,configurable:true},r));return t}function te(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})}function ee(t){if(console&&console.warn){console.warn(t)}}var ne=Object.freeze({contains:Zt,each:Qt,getPropDescriptor:xt,startsWith:Jt,uid:Xt,defineProperty:Yt,objectCreate:jt,extend:Ot,toCamel:te,warn:ee});function re(t,e,n,r,i){var a=t[e];var o=Kt(a);var s=!Nt(i);if(a&&a===n){return}if(!a&&r){t[e]=[n]}else if(!a){t[e]=n}else{if(o){var u=a.indexOf(n);if(u===i){return}if(u!==-1){a.splice(u,1)}if(s){a.splice(i,0,n)}else{a.push(n)}}else{t[e]=[a,n]}}}function ie(t){return t.tagName&&M[Lt(t,U)||Lt(t,U)||t.tagName.toLowerCase()]}function ae(t,e){var n=ie(t);var r=!e&&Lt(t,U);return r&&!wt.hasExpr(r)?r:n?n.name:t.tagName.toLowerCase()}function oe(){if(this.parent){return Ot(jt(this),this.parent)}return this}var se=/<yield\b/i,ue=/<yield\s*(?:\/>|>([\S\s]*?)<\/yield\s*>|>)/gi,fe=/<yield\s+to=['"]([^'">]*)['"]\s*>([\S\s]*?)<\/yield\s*>/gi,le=/<yield\s+from=['"]?([-\w]+)['"]?\s*(?:\/>|>([\S\s]*?)<\/yield\s*>)/gi,ce={tr:"tbody",th:"tr",td:"tr",col:"colgroup"},pe=ft&&ft<10?rt:it,he="div",ve="svg";function de(t,e,n){var r=n[0]==="o",i=r?"select>":"table>";t.innerHTML="<"+i+e.trim()+"</"+i;i=t.firstChild;if(r){i.selectedIndex=-1}else{var a=ce[n];if(a&&i.childElementCount===1){i=I(a,i)}}return i}function ge(t,n){if(!se.test(t)){return t}var r={};n=n&&n.replace(fe,function(t,e,n){r[e]=r[e]||n;return""}).trim();return t.replace(le,function(t,e,n){return r[e]||n||""}).replace(ue,function(t,e){return n||e||""})}function me(t,e,n){var r=t&&t.match(/^\s*<([-\w]+)/);var i=r&&r[1].toLowerCase();var a=lt(n?ve:he);t=ge(t,e);if(pe.test(i)){a=de(a,t,i)}else{Rt(a,t,n)}return a}function ye(t){var e=t;while(e.__.isAnonymous){if(!e.parent){break}e=e.parent}return e}function _e(t,e,n){var r=this.__.parent;var i=this.__.item;if(!i){while(r&&!i){i=r.__.item;r=r.__.parent}}if(At(n,"currentTarget")){n.currentTarget=t}if(At(n,"target")){n.target=n.srcElement}if(At(n,"which")){n.which=n.charCode||n.keyCode}n.item=i;e.call(this,n);if(!Ct.autoUpdate){return}if(!n.preventUpdate){var a=ye(this);if(a.isMounted){a.update()}}}function we(t,e,n,r){var i;var a=_e.bind(r,n,e);n[t]=null;i=t.replace(at,"");if(!Zt(r.__.listeners,n)){r.__.listeners.push(n)}if(!n[W]){n[W]={}}if(n[W][t]){n.removeEventListener(i,n[W][t])}n[W][t]=a;n.addEventListener(i,a,false)}function be(t,e,n,r){var i=hn(t,e,n);var a=e.tagName||ae(e.root,true);var o=ye(r);Yt(i,"parent",o);i.__.parent=r;re(o.tags,a,i);if(o!==r){re(r.tags,a,i)}return i}function xe(t,e,n,r){if(Kt(t[e])){var i=t[e].indexOf(n);if(i!==-1){t[e].splice(i,1)}if(!t[e].length){delete t[e]}else if(t[e].length===1&&!r){t[e]=t[e][0]}}else if(t[e]===n){delete t[e]}}function Ne(t,e){var n=this;var r=Et();var i=Et();var a=Pt();var o;var s;this.root.insertBefore(r,this.root.firstChild);this.root.appendChild(i);this.__.head=s=r;this.__.tail=i;while(s){o=s.nextSibling;a.appendChild(s);n.__.virts.push(s);s=o}if(e){t.insertBefore(a,e.__.head)}else{t.appendChild(a)}}function Ae(t,e){var n=Pt();Ne.call(t,n);e.parentNode.replaceChild(n,e)}function Oe(t,e,n){var r=t.tag||t.dom._tag;var i;var a=r?r.__:{};var o=a.head;var s=t.dom.tagName==="VIRTUAL";if(r&&t.tagName===n){r.update();return}if(r){if(s){i=Et();o.parentNode.insertBefore(i,o)}r.unmount(true)}if(!Gt(n)){return}t.impl=M[n];if(!t.impl){return}t.tag=r=be(t.impl,{root:t.dom,parent:e,tagName:n},t.dom.innerHTML,e);Qt(t.attrs,function(t){return ct(r.root,t.name,t.value)});t.tagName=n;r.mount();if(s){Ae(r,i||r.root)}e.__.onUnmount=function(){var t=r.opts.dataIs;xe(r.parent.tags,t,r);xe(r.__.parent.tags,t,r);r.unmount()}}function je(t){if(!t){return null}t=t.replace(V,"");if(st[t]){t=st[t]}return t}function Ce(t){if(this.root&&Lt(this.root,"virtualized")){return}var e=t.dom;var n=je(t.attr);var r=Zt([K,q],n);var i=t.root&&t.root.tagName==="VIRTUAL";var a=this.__;var o=a.isAnonymous;var s=e&&(t.parent||e.parentNode);var u=n==="style";var f=n==="class";var l;if(t._riot_id){if(t.__.wasCreated){t.update()}else{t.mount();if(i){Ae(t,t.root)}}return}if(t.update){return t.update()}var c=r&&!o?oe.call(this):this;l=wt(t.expr,c);var p=!Ut(l);var h=Dt(l);if(h){if(f){l=wt(JSON.stringify(l),this)}else if(u){l=Bt(l)}}if(t.attr&&(!t.wasParsedOnce||!p||l===false)){St(e,Lt(e,t.attr)?t.attr:n)}if(t.bool){l=l?n:false}if(t.isRtag){return Oe(t,this,l)}if(t.wasParsedOnce&&t.value===l){return}t.value=l;t.wasParsedOnce=true;if(h&&!f&&!u&&!r){return}if(!p){l=""}if(!n){l+="";if(s){t.parent=s;if(s.tagName==="TEXTAREA"){s.value=l;if(!ft){e.nodeValue=l}}else{e.nodeValue=l}}return}if(Ht(l)){we(n,l,e,this)}else if(r){kt(e,n===q?!l:l)}else{if(t.bool){e[n]=l}if(n==="value"&&e.value!==l){e.value=l}else if(p&&l!==false){ct(e,n,l)}if(u&&e.hidden){kt(e,false)}}}function Te(t){Qt(t,Ce.bind(this))}function Ee(t,e,n,r,i){if(t&&n){return}var a=t?oe.call(this):e||this;Qt(i,function(t){if(t.expr){Ce.call(a,t.expr)}r[te(t.name).replace(V,"")]=t.expr?t.expr.value:t.value})}function ke(t,e,n){var r=t.__;var i={};var a=t.isMounted&&!r.skipAnonymous;if(r.isAnonymous&&r.parent){Ot(t,r.parent)}Ot(t,e);Ee.apply(t,[r.isLoop,r.parent,r.isAnonymous,i,r.instAttrs]);if(a&&t.isMounted&&Ht(t.shouldUpdate)&&!t.shouldUpdate(e,i)){return t}Ot(t.opts,i);if(a){t.trigger("update",e)}Te.call(t,n);if(a){t.trigger("updated")}return t}function Le(t){if(!t){var e=Object.keys(M);return e+Le(e)}return t.filter(function(t){return!/[^-\w]/.test(t)}).reduce(function(t,e){var n=e.trim().toLowerCase();return t+",["+U+'="'+n+'"]'},"")}function Se(t,e){var n=this;var r=n.name;var i=n.tmpl;var a=n.css;var o=n.attrs;var s=n.onCreate;if(!M[r]){Re(r,i,a,o,s);M[r].class=this.constructor}vn(t,r,e,this);if(a){mt.inject()}return this}function Re(t,e,n,r,i){if(Ht(r)){i=r;if(/^[\w-]+\s?=/.test(n)){r=n;n=""}else{r=""}}if(n){if(Ht(n)){i=n}else{mt.add(n)}}t=t.toLowerCase();M[t]={name:t,tmpl:e,attrs:r,fn:i};return t}function Ie(t,e,n,r,i){if(n){mt.add(n,t)}M[t]={name:t,tmpl:e,attrs:r,fn:i};return t}function Pe(t,r,i){var a=[];var e,n;function o(t){if(t.tagName){var e=Lt(t,U),n;if(r&&e!==r){e=r;ct(t,U,r)}n=vn(t,e||t.tagName.toLowerCase(),i);if(n){a.push(n)}}else if(t.length){Qt(t,o)}}mt.inject();if(Dt(r)){i=r;r=0}if(Gt(t)){t=t==="*"?n=Le():t+Le(t.split(/, */));e=t?Tt(t):[]}else{e=t}if(r==="*"){r=n||Le();if(e.tagName){e=Tt(r,e)}else{var s=[];Qt(e,function(t){return s.push(Tt(r,t))});e=s}r=0}o(e);return a}var Me={};var Be=Me[F]={};var Fe=0;function Ve(t,e,n){if(Dt(t)){Ve("__"+Fe+++"__",t,true);return}var r=n?Be:Me;if(!e){if(Nt(r[t])){throw new Error("Unregistered mixin: "+t)}return r[t]}r[t]=Ht(e)?Ot(e.prototype,r[t]||{})&&e:Ot(r[t]||{},e)}function $e(){return Qt(P,function(t){return t.update()})}function Ue(t){M[t]=null}var He="WIP";var De=Object.freeze({Tag:Se,tag:Re,tag2:Ie,mount:Pe,mixin:Ve,update:$e,unregister:Ue,version:He});function ze(o){var t=[],e=arguments.length-1;while(e-- >0)t[e]=arguments[e+1];Qt(t,function(t){var r;var e;var n=[];var i=["init","__proto__"];t=Gt(t)?Ve(t):t;if(Ht(t)){r=new t}else{r=t}var a=Object.getPrototypeOf(r);do{n=n.concat(Object.getOwnPropertyNames(e||r))}while(e=Object.getPrototypeOf(e||r));Qt(n,function(t){if(!Zt(i,t)){var e=xt(r,t)||xt(a,t);var n=e&&(e.get||e.set);if(!o.hasOwnProperty(t)&&n){Object.defineProperty(o,t,e)}else{o[t]=Ht(r[t])?r[t].bind(o):r[t]}}});if(r.init){r.init.bind(o)(o.opts)}});return o}function Ke(t,e){var n=this.parent;var r;if(!n){return}r=n.tags[t];if(Kt(r)){r.splice(e,0,r.splice(r.indexOf(this),1)[0])}else{re(n.tags,t,this)}}function qe(t,e){var n=this;var r=this.__.head;var i;var a=Pt();while(r){i=r.nextSibling;a.appendChild(r);r=i;if(r===n.__.tail){a.appendChild(r);t.insertBefore(a,e.__.head);break}}}function Ge(t,e,n,r){var i=r?jt(r):{};i[t.key]=e;if(t.pos){i[t.pos]=n}return i}function We(t,e){var n=e.length;var r=t.length;while(n>r){n--;Ze.apply(e[n],[e,n])}}function Ze(t,e){t.splice(e,1);this.unmount();xe(this.parent,this,this.__.tagName,true)}function Qe(e){var n=this;Qt(Object.keys(this.tags),function(t){Ke.apply(n.tags[t],[t,e])})}function Je(t,e,n){if(n){qe.apply(this,[t,e])}else{Mt(t,this.root,e.root)}}function Xe(t,e,n){if(n){Ne.apply(this,[t,e])}else{Mt(t,this.root,e.root)}}function Ye(t,e){if(e){Ne.call(this,t)}else{t.appendChild(this.root)}}function tn(t,e,n,r){if(t){return r?wt(t,n):e[t]}return e}function en(d,g,m){var y=typeof Lt(d,z)!==Z||St(d,z);var _=Lt(d,G);var w=_?wt.hasExpr(_):false;var b=ae(d);var x=M[b];var t=d.parentNode;var e=Et();var N=ie(d);var r=Lt(d,H);var A=[];var O=true;var j=d.innerHTML;var C=!M[b];var T=d.tagName==="VIRTUAL";var E=[];var k;St(d,D);St(d,G);m=wt.loopKeys(m);m.isLoop=true;if(r){St(d,H)}t.insertBefore(e,d);t.removeChild(d);m.update=function t(){m.value=wt(m.val,g);var c=m.value;var p=Pt();var n=!Kt(c)&&!Gt(c);var h=e.parentNode;var v=[];if(!h){return}if(n){k=c||false;c=k?Object.keys(c).map(function(t){return Ge(m,c[t],t)}):[]}else{k=false}if(r){c=c.filter(function(t,e){if(m.key&&!n){return!!wt(r,Ge(m,t,e,g))}return!!wt(r,Ot(jt(g),t))})}Qt(c,function(t,e){var n=!k&&m.key?Ge(m,t,e):t;var r=tn(_,t,n,w);var i=y&&typeof t===Q&&!k;var a=E.indexOf(r);var o=a===-1;var s=!o&&i?a:e;var u=A[s];var f=e>=E.length;var l=i&&o||!i&&!u;if(l){u=hn(x,{parent:g,isLoop:O,isAnonymous:C,tagName:b,root:d.cloneNode(C),item:n,index:e},j);u.mount();if(f){Ye.apply(u,[p||h,T])}else{Xe.apply(u,[h,A[e],T])}if(!f){E.splice(e,0,n)}A.splice(e,0,u);if(N){re(g.tags,b,u,true)}}else if(s!==e&&i){if(_||Zt(c,E[s])){Je.apply(u,[h,A[e],T]);A.splice(e,0,A.splice(s,1)[0]);E.splice(e,0,E.splice(s,1)[0])}if(m.pos){u[m.pos]=e}if(!N&&u.tags){Qe.call(u,e)}}Ot(u.__,{item:n,index:e,parent:g});v[e]=r;if(!l){u.update(n)}});We(c,A);E=v.slice();h.insertBefore(p,e)};m.unmount=function(){Qt(A,function(t){t.unmount()})};return m}var nn={init:function t(e,n,r,i){this.dom=e;this.attr=r;this.rawValue=i;this.parent=n;this.hasExp=wt.hasExpr(i);return this},update:function t(){var e=this.value;var n=this.parent&&ye(this.parent);var r=this.dom.__ref||this.tag||this.dom;this.value=this.hasExp?wt(this.rawValue,this.parent):this.rawValue;if(!Ut(e)&&n){xe(n.refs,e,r)}if(!Ut(this.value)&&Gt(this.value)){if(n){re(n.refs,this.value,r,null,this.parent.__.index)}if(this.value!==e){ct(this.dom,this.attr,this.value)}}else{St(this.dom,this.attr)}if(!this.dom.__ref){this.dom.__ref=r}},unmount:function t(){var e=this.tag||this.dom;var n=this.parent&&ye(this.parent);if(!Ut(this.value)&&n){xe(n.refs,this.value,e)}}};function rn(t,e,n,r){return jt(nn).init(t,e,n,r)}function an(t){Qt(t,function(t){if(t.unmount){t.unmount(true)}else if(t.tagName){t.tag.unmount(true)}else if(t.unmount){t.unmount()}})}var on={init:function t(e,n,r){St(e,H);Ot(this,{tag:n,expr:r,stub:Et(),pristine:e});var i=e.parentNode;i.insertBefore(this.stub,e);i.removeChild(e);return this},update:function t(){this.value=wt(this.expr,this.tag);if(this.value&&!this.current){this.current=this.pristine.cloneNode(true);this.stub.parentNode.insertBefore(this.current,this.stub);this.expressions=un.apply(this.tag,[this.current,true])}else if(!this.value&&this.current){an(this.expressions);if(this.current._tag){this.current._tag.unmount()}else if(this.current.parentNode){this.current.parentNode.removeChild(this.current)}this.current=null;this.expressions=[]}if(this.value){Te.call(this.tag,this.expressions)}},unmount:function t(){an(this.expressions||[])}};function sn(t,e,n){return jt(on).init(t,e,n)}function un(o,s){var u=this;var f=[];Ft(o,function(t){var e=t.nodeType;var n;var r;if(!s&&t===o){return}if(e===3&&t.parentNode.tagName!=="STYLE"&&wt.hasExpr(t.nodeValue)){f.push({dom:t,expr:t.nodeValue})}if(e!==1){return}var i=t.tagName==="VIRTUAL";if(n=Lt(t,D)){if(i){ct(t,"loopVirtual",true)}f.push(en(t,u,n));return false}if(n=Lt(t,H)){f.push(sn(t,u,n));return false}if(n=Lt(t,U)){if(wt.hasExpr(n)){f.push({isRtag:true,expr:n,dom:t,attrs:[].slice.call(t.attributes)});return false}}r=ie(t);if(i){if(Lt(t,"virtualized")){t.parentElement.removeChild(t)}if(!r&&!Lt(t,"virtualized")&&!Lt(t,"loopVirtual")){r={tmpl:t.outerHTML}}}if(r&&(t!==o||s)){if(i){if(Lt(t,U)){ee("Virtual tags shouldn't be used together with the \""+U+'" attribute - https://github.com/riot/riot/issues/2511')}ct(t,"virtualized",true);var a=hn({tmpl:t.outerHTML},{root:t,parent:u},t.innerHTML);f.push(a)}else{f.push(be(r,{root:t,parent:u},t.innerHTML,u));return false}}fn.apply(u,[t,t.attributes,function(t,e){if(!e){return}f.push(e)}])});return f}function fn(i,t,a){var o=this;Qt(t,function(t){if(!t){return false}var e=t.name;var n=qt(e);var r;if(Zt($,e)&&i.tagName.toLowerCase()!==B){r=rn(i,o,e,t.value)}else if(wt.hasExpr(t.value)){r={dom:i,expr:t.value,attr:e,bool:n}}a(t,r)})}function ln(t){var e=this.__;var n=e.isAnonymous;Yt(this,"isMounted",t);if(!n){if(t){this.trigger("mount")}else{this.trigger("unmount");this.off("*");this.__.wasCreated=false}}}function cn(n,t,r,e){var i=n.__;var a=i.root;a._tag=n;fn.apply(i.parent,[a,a.attributes,function(t,e){if(!i.isAnonymous&&nn.isPrototypeOf(e)){e.tag=n}t.expr=e;i.instAttrs.push(t)}]);It(i.impl.attrs,function(t,e){i.implAttrs.push({name:t,value:e})});fn.apply(n,[a,i.implAttrs,function(t,e){if(e){r.push(e)}else{ct(a,t.name,t.value)}}]);Ee.apply(n,[i.isLoop,i.parent,i.isAnonymous,e,i.instAttrs]);var o=Ve(F);if(o&&!i.skipAnonymous){for(var s in o){if(o.hasOwnProperty(s)){n.mixin(o[s])}}}if(i.impl.fn){i.impl.fn.call(n,e)}if(!i.skipAnonymous){n.trigger("before-mount")}Qt(un.apply(n,[t,i.isAnonymous]),function(t){return r.push(t)});n.update(i.item);if(!i.isAnonymous&&!i.isInline){while(t.firstChild){a.appendChild(t.firstChild)}}Yt(n,"root",a);if(!i.skipAnonymous&&n.parent){var u=ye(n.parent);u.one(!u.isMounted?"mount":"updated",function(){ln.call(n,true)})}else{ln.call(n,true)}n.__.wasCreated=true;return n}function pn(e,t,n){var r=e.__;var i=r.root;var a=P.indexOf(e);var o=i.parentNode;if(!r.skipAnonymous){e.trigger("before-unmount")}It(r.impl.attrs,function(t){if(Jt(t,V)){t=t.slice(V.length)}St(i,t)});e.__.listeners.forEach(function(e){Object.keys(e[W]).forEach(function(t){e.removeEventListener(t,e[W][t])})});if(a!==-1){P.splice(a,1)}if(r.parent&&!r.isAnonymous){var s=ye(r.parent);if(r.isVirtual){Object.keys(e.tags).forEach(function(t){return xe(s.tags,t,e.tags[t])})}else{xe(s.tags,r.tagName,e)}}if(e.__.virts){Qt(e.__.virts,function(t){if(t.parentNode){t.parentNode.removeChild(t)}})}an(n);Qt(r.instAttrs,function(t){return t.expr&&t.expr.unmount&&t.expr.unmount()});if(t){Rt(i,"")}else if(o){o.removeChild(i)}if(r.onUnmount){r.onUnmount()}if(!e.isMounted){ln.call(e,true)}ln.call(e,false);delete i._tag;return e}function hn(t,e,n){if(t===void 0)t={};if(e===void 0)e={};var r=e.context||{};var i=Ot({},e.opts);var a=e.parent;var o=e.isLoop;var s=!!e.isAnonymous;var u=Ct.skipAnonymousTags&&s;var f=e.item;var l=e.index;var c=[];var p=[];var h=[];var v=e.root;var d=e.tagName||ae(v);var g=d==="virtual";var m=!g&&!t.tmpl;var y;if(!u){bt(r)}if(t.name&&v._tag){v._tag.unmount(true)}Yt(r,"isMounted",false);Yt(r,"__",{impl:t,root:v,skipAnonymous:u,implAttrs:p,isAnonymous:s,instAttrs:c,innerHTML:n,tagName:d,index:l,isLoop:o,isInline:m,item:f,parent:a,listeners:[],virts:[],wasCreated:false,tail:null,head:null});Yt(r,"_riot_id",Xt());Yt(r,"root",v);Ot(r,{opts:i},f);Yt(r,"parent",a||null);Yt(r,"tags",{});Yt(r,"refs",{});if(m||o&&s){y=v}else{if(!g){v.innerHTML=""}y=me(t.tmpl,n,zt(v))}Yt(r,"update",function(t){return ke(r,t,h)});Yt(r,"mixin",function(){var t=[],e=arguments.length;while(e--)t[e]=arguments[e];return ze.apply(void 0,[r].concat(t))});Yt(r,"mount",function(){return cn(r,y,h,i)});Yt(r,"unmount",function(t){return pn(r,t,h)});return r}function vn(t,e,n,r){var i=M[e];var a=M[e].class;var o=r||(a?jt(a.prototype):{});var s=t._innerHTML=t._innerHTML||t.innerHTML;var u=Ot({root:t,opts:n,context:o},{parent:n?n.parent:null});var f;if(i&&t){f=hn(i,u,s)}if(f&&f.mount){f.mount(true);if(!Zt(P,f)){P.push(f)}}return f}var dn=Object.freeze({arrayishAdd:re,getTagName:ae,inheritParentProps:oe,mountTo:vn,selectTags:Le,arrayishRemove:xe,getTag:ie,initChildTag:be,moveChildTag:Ke,makeReplaceVirtual:Ae,getImmediateCustomParentTag:ye,makeVirtual:Ne,moveVirtual:qe,unmountAll:an,createIfDirective:sn,createRefDirective:rn});var gn=Ct;var mn={tmpl:wt,brackets:_t,styleManager:mt,vdom:P,styleNode:mt.styleNode,dom:Vt,check:Wt,misc:ne,tags:dn};var yn=Ot({},De,{observable:bt,settings:gn,util:mn});var _n=function(t){var e=[],n=arguments.length-1;while(n-- >0)e[n]=arguments[n+1];e.unshift("[riotx]");try{console.log.apply(console,e)}catch(t){console.log(e)}};var wn={debug:false,default:"@",changeBindName:"riotxChange",strict:false,logger:{output:_n}};var bn=function(){var t=[],e=arguments.length;while(e--)t[e]=arguments[e];if(!wn.debug){return}t.unshift("DEBUG");wn.logger.output.apply(null,t)};var xn=function(t){var e=new Error("[riotx] "+t);wn.logger.output.apply(null,["ERROR",e]);throw e};var Nn=function t(e){var n=this;this.name=e.name;if(!this.name){this.name=wn.default;bn("Default store name. name="+this.name)}this._state=e.state;Object.defineProperty(this,"state",{get:function(){if(wn.strict){xn("[strict] Direct access get error.")}return n._state},set:function(t){if(wn.strict){xn("[strict] Direct access set error. "+t)}n._state=t}});this._actions=e.actions;this._mutations=e.mutations;this._getters=e.getters;this._plugins=e.plugins;yn.observable(this);u(this._plugins,function(t){if(!b(t)||!s(t)){xn("[plugin] The plugin is not a function.")}t.apply(null,[n])})};Nn.prototype.reset=function t(){this.name=null;this._state=null;this._actions=null;this._mutations=null;this._getters=null;this._plugins=null;this.off("*")};Nn.prototype.getter=function t(e,n){if(n&&!N(n)){xn("[getter]', 'The getter data is not object type. name="+e+" data="+n)}var r={state:this._state};var i=this._getters[e];if(!i||!b(i)||!s(i)){xn("[getter]', 'The getter is not a function. name="+e+" data="+n)}bn("[getter]",e,n);return i.apply(null,[r,n])};Nn.prototype.commit=function t(e,n){var r=this;if(n&&!N(n)){xn("[mutation]', 'The mutation data is not object type. name="+e+" data="+n)}var i={getter:function(t,e){return r.getter.apply(r,[t,e])},state:this._state};var a=this._mutations[e];if(!a||!b(a)||!s(a)){xn("[mutation]', 'The mutation is not a function. name="+e+" data="+n)}bn("[mutation(before)]",e,this._state,n);var o=a.apply(null,[i,n]);bn("[mutation(after)]",e,this._state,n);this.trigger("riotx:mutations:after",e,o,i,n);u(o,function(t){r.trigger(t,r._state,r)})};Nn.prototype.action=function t(e,n){var r=this;if(n&&!N(n)){xn("[action]', 'The action data is not object type. name="+e+" data="+n)}var i={getter:function(t,e){return r.getter.apply(r,[t,e])},commit:function(t,e){r.commit(t,e)}};var a=this._actions[e];if(!a||!b(a)||!s(a)){xn("[action] The action is not a function. name="+e+" data="+n)}bn("[action]",e,n);return C.resolve().then(function(){return a.apply(null,[i,n])})};Nn.prototype.change=function t(){var e;var n=[],r=arguments.length;while(r--)n[r]=arguments[r];(e=this).on.apply(e,n)};var An=function t(){this.version=e||"";this.Store=Nn;this.stores={};var n=function(t,e,n){var r=[],i=arguments.length-3;while(i-- >0)r[i]=arguments[i+3];this._riotx_change_handlers.push({store:t,evtName:e,handler:n});r.unshift(n);r.unshift(e);t.change.apply(t,r)};yn.mixin({init:function(){var e=this;this.on("unmount",function(){e.off("*");u(e._riotx_change_handlers,function(t){t.store.off(t.evtName,t.handler)});delete e.riotx;delete e._riotx_change_handlers;delete e[wn.changeBindName]});if(wn.debug){this.on("*",function(t){bn("[riot.mixin]",t,e)})}this._riotx_change_handlers=[];this[wn.changeBindName]=n},riotx:this})};An.prototype.add=function t(e){if(this.stores[e.name]){xn("[store.add] The store instance named `"+e.name+"` already exists.")}this.stores[e.name]=e;return this};An.prototype.get=function t(e){if(e===void 0)e=wn.default;return this.stores[e]};An.prototype.debug=function t(e){wn.debug=!!e;return this};An.prototype.setChangeBindName=function t(e){wn.changeBindName=e;return this};An.prototype.strict=function t(e){wn.strict=!!e;return this};An.prototype.logger=function t(e){wn.logger.output=e;return this};An.prototype.reset=function t(){o(this.stores||{},function(t){t.reset()});this.stores={};return this};An.prototype.size=function t(){return d(this.stores).length};var On=new An;return On});